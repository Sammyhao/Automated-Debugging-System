 How to Iterate over rows and columns in PySpark dataframe  Last Updated : 23 Dec, 2021  In this article, we will discuss how to iterate rows and columns in PySpark dataframe.  Create the dataframe for demonstration:  Python3  Output:  Method 1: Using collect()  This method will collect all the rows and columns of the dataframe and then loop through it using for loop. Here an iterator is used to iterate over a loop from the collected elements using the collect() method.  where,  dataframe is the input dataframe  itertator is used to collect rows  Example: Here we are going to iterate all the columns in the dataframe with collect() method and inside the for loop, we are specifying iterator[‘column_name’] to get column values.  Python3  Output:  Method 2: Using toLocalIterator()  It will return the iterator that contains all rows and columns in RDD. It is similar to the collect() method, But it is in rdd format, so it is available inside the rdd method. We can use the toLocalIterator() with rdd like:  For iterating the all rows and columns we are iterating this inside an for loop  where,  dataframe is the input dataframe  itertator is used to collect rows  Example: Here we are going to iterate all the columns in the dataframe with toLocalIterator() method and inside the for loop, we are specifying iterator[‘column_name’] to get column values.  Python3  Output:  Method 3: Using iterrows()  This will iterate rows. Before that, we have to convert our PySpark dataframe into Pandas dataframe using toPandas() method. This method is used to iterate row by row in the dataframe.  Syntax: dataframe.toPandas().iterrows()  Example: In this example, we are going to iterate three-column rows using iterrows() using for loop.  Python3  Output:  Method 4: Using select()  The select() function is used to select the number of columns. we are then using the collect() function to get the rows through for loop.  The select method will select the columns which are mentioned and get the row data using collect() method. This method will collect rows from the given columns.  Example: Here we are going to select ID and Name columns from the given dataframe using the select() method  Python3  This will act as a loop to get each row and finally we can use for loop to get particular columns, we are going to iterate the data in the given column using the collect() method through rdd.  Syntax: dataframe.rdd.collect()  Example: Here we are going to iterate rows in NAME column.  Python3  In this method, we will use map() function, which returns a new vfrom a given dataframe or RDD. The map() function is used with the lambda function to iterate through each row of the pyspark Dataframe.  For looping through each row using map() first we have to convert the PySpark dataframe into RDD because map() is performed on RDD’s only, so first convert into RDD it then use map() in which, lambda function for iterating through each row and stores the new RDD in some variable then convert back that new RDD into Dataframe using toDF() by passing schema into it.  Syntax:  Example: Here we are going to iterate ID and NAME column  Writing code in comment? Please use ide.geeksforgeeks.org, generate link and share the link here.  We use cookies to ensure you have the best browsing experience on our website. By using our site, you acknowledge that you have read and understood our Cookie Policy & Privacy Policy Got It !  