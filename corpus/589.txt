 your communities  Find centralized, trusted content and collaborate around the technologies you use most.  Connect and share knowledge within a single location that is structured and easy to search.  I've a spark application that runs a complicated map function over a dataset. This map function can fail for mainly data related reasons. How can I get some meaningful information on what went wrong? I'm not sure where to start.  2 Answers 2  If you want to write unit tests, you can generate a dataset from a collection, map over it using your map function and test the result with a collect using your favourite test suite.  If you're using PySpark I don't really know how you could debug a Spark Job but with distributed computing engine, debug mode is always a mess so I don't even think it's worthy to explore this path.  In my company we usually go for unit testing when we want to test the logic of a specific function so you should be good to go.  3,27555 gold badges3434 silver badges5555 bronze badges  4  The code runs fine over specific test datasets. Its when I run over a large input dataset there are specific values in there that cause the logic to fail. I'd like to know what those values are. It might only be 1 in 1000 input sets that fail, so spot checking some isn't helpful. I might just have bad values in the dataset.  What does it means "to fail"? If it throws an exception, try to catch it. If it produces wrong values, just return (input, output) instead of just (output) and watch (maybe with a filter) what kind of input produced the anomaly in the output.  Lets say it throws an exception and I catch it in the map function. What can do with it then? Can I log it? Where do those logs go?  It depends on your logging configuration. Anyway you can catch them and output them (bundling them with the input) so you can find them in the result of your computation.  Ok, so this is indeed possible, but there are some pitfalls.  Broadly, create a class that encapsulates your results from the map function eg  Then you can test the wasError field in order to log exceptions.  The exception object cannot be a traceback object as they are not pickable. So, I suggest a formatted string.  By clicking “Accept all cookies”, you agree Stack Exchange can store cookies on your device and disclose information in accordance with our Cookie Policy.  