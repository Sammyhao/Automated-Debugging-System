 your communities  Find centralized, trusted content and collaborate around the technologies you use most.  Connect and share knowledge within a single location that is structured and easy to search.  I don't understand why I have a runtime error and an explanation with suggestions would be greatly appreciated!  I have written a long macro that essentially uses the values in a sheet to calculate a scale of color, dependent upon the limits entered elsewhere on the sheet. What I need it to do is save the cells in a row from column 6 to 17 in an array and then later use that array to find the maximum or minimum value. I would have tried using WorksheetFunction.Max, but many of the values are going to contain letters (I have a custom function that converts the strings to decimals), and if there are any blanks in the middle of the range it causes an error. So I thought to circumvent that error by only finding the max of values that are not blank.  I am trying to do this: for every value in the array, use the conversion function, then return the largest one.  I need that to be a custom function to make Sub FormatReportCard() more readable, as I use the Max and Min function in multiple places and I use them to do math.  I have read a number of forum posts on this error, and I suspect that my array is "empty" causing the runtime error in the function, but I can't figure out why. I tried filling it with a dummy range, I've tried using the () or not using the () in various places. I tried switching different components with between Range and Variant. different variable types. I tried using a message box to tell me if the array gets anything assigned to it, but the runtime error prevents me from getting that far.  Instead of it's easier to do and then loop over the cells in . Then you can skip the row-tracking stuff.  Maybe "if there are any blanks in the middle of the range it causes an error" is your problem. At which code line the error appears? If the are problematic you must escape them and use only the appropriate data, I think.  Yes, that is the original problem. This is the original method of determining the midpoint: Picture has been edited in. This is flawed because it uses only the first and last values.  You have CustomMax expecting an array of ranges, but you pass it a single multi cell range. Change CustomMax to receive a single range and loop over its cells  1 Answer 1  ...but the last thing you do in that block is set , so this following block never runs:  You can do something like this:  EDIT - now a bit closer to your original method...  131k88 gold badges8686 silver badges107107 bronze badges  3  Thanks for the edit. I was scratching my head trying to figure out why wouldn't throw an error, being equal to on the first iteration and having a lower bound of . I think you found the reason why.  Okay, so the lower approach you suggested seems to have addressed the issue. A few type errors came up that were easily addressed by switching my variables to Doubles. But now my array is returning 0 when I take the min. I thought Max and Min were supposed to ignore blank entries and text entries, so I'm not sure where that 0 is coming from  Update: The 0's were a result of numbers not being converted to Doubles. The Max(Array) approach is working perfectly now. Thank you!  By clicking “Accept all cookies”, you agree Stack Exchange can store cookies on your device and disclose information in accordance with our Cookie Policy.  